# =============================================================================
# üöÄ LOOKESCOLAR PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# CRITICAL: Update ALL values before production deployment
# Generate secure values: https://www.uuidgenerator.net/
# Password generator: https://passwordsgenerator.net/
# =============================================================================

# =============================================================================
# üèóÔ∏è  CORE INFRASTRUCTURE
# =============================================================================

# Supabase (REQUIRED)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
DATABASE_URL=postgresql://postgres:[password]@[host]:5432/postgres

# Application URLs (REQUIRED)
NEXT_PUBLIC_APP_URL=https://your-domain.com
CORS_ORIGIN=https://your-domain.com
ALLOWED_DOMAINS=your-domain.com,www.your-domain.com

# Session Security (REQUIRED - min 32 characters)
SESSION_SECRET=your_super_secure_session_secret_min_32_characters_long

# =============================================================================
# üí∞ PAYMENT INTEGRATION
# =============================================================================

# Mercado Pago (REQUIRED)
NEXT_PUBLIC_MP_PUBLIC_KEY=TEST-your-public-key-here
MP_ACCESS_TOKEN=TEST-your-access-token-here
MP_WEBHOOK_SECRET=your_webhook_secret_min_32_chars

# Payment Environment
NEXT_PUBLIC_MP_ENVIRONMENT=sandbox # Change to 'production' for live payments

# =============================================================================
# üîí SECURITY CONFIGURATION
# =============================================================================

# Environment
NODE_ENV=production

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_REPORT_URI=https://your-monitoring-service.com/csp-report

# Authentication
SKIP_AUTH=false # NEVER set to true in production

# Token Security (CRITICAL)
TOKEN_MIN_LENGTH=20
TOKEN_MAX_LENGTH=64
TOKEN_EXPIRY_DAYS=30
TOKEN_ROTATION_WARNING_DAYS=7

# =============================================================================
# üìÅ STORAGE CONFIGURATION
# =============================================================================

# Supabase Storage
STORAGE_BUCKET=photos-private-bucket
SIGNED_URL_EXPIRY_MINUTES=60
MAX_FILE_SIZE=10485760  # 10MB
MAX_FILES_PER_REQUEST=20
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,image/tiff

# Photo Processing
MAX_CONCURRENT_UPLOADS=5
WATERMARK_OPACITY=0.5
PHOTO_MAX_SIZE=1600
PHOTO_QUALITY=72
PHOTO_FORMAT=webp

# Storage Cleanup
AUTO_CLEANUP_ENABLED=true
PREVIEW_RETENTION_DAYS=90
TEMP_FILE_CLEANUP_HOURS=24

# =============================================================================
# üõ°Ô∏è  RATE LIMITING & DDoS PROTECTION
# =============================================================================

# Global Rate Limiting
ENABLE_RATE_LIMIT=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESS_RATE=false

# Upstash Redis (REQUIRED for rate limiting)
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your_redis_token_here

# Endpoint-Specific Rate Limits (requests per minute per IP)
RATE_LIMIT_AUTH=3           # Login attempts
RATE_LIMIT_UPLOAD=10        # Photo uploads
RATE_LIMIT_GALLERY=30       # Gallery access
RATE_LIMIT_WEBHOOK=100      # Payment webhooks
RATE_LIMIT_SIGNED_URL=60    # URL generation

# Advanced Rate Limiting
RATE_LIMIT_ENABLE_HEADERS=true
RATE_LIMIT_RESET_ON_SUCCESS=false
RATE_LIMIT_BLOCK_DURATION=900 # 15 minutes

# =============================================================================
# üìä MONITORING & OBSERVABILITY
# =============================================================================

# Logging Configuration
LOG_LEVEL=warn                # production: warn, development: info
MASK_SENSITIVE_LOGS=true      # NEVER set to false in production
MAX_LOG_SIZE=1000
LOG_FORMAT=json
LOG_STRUCTURED=true

# Health Monitoring
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=0.1  # 10% of requests
MAX_RESPONSE_TIME_WARNING=200

# Error Monitoring (Sentry, LogRocket, etc.)
ERROR_MONITORING_DSN=https://your-error-monitoring-dsn
ERROR_MONITORING_ENVIRONMENT=production

# Metrics Collection
ENABLE_METRICS=true
METRICS_ENDPOINT=/api/metrics
METRICS_AUTH_TOKEN=your_metrics_auth_token

# Egress Monitoring (CRITICAL for Supabase limits)
ENABLE_EGRESS_MONITORING=true
EGRESS_WARNING_THRESHOLD=80  # Percent of monthly limit
EGRESS_CRITICAL_THRESHOLD=95
MONTHLY_EGRESS_LIMIT=107374182400  # 100GB in bytes

# Security Configuration (New)
STORAGE_BUCKET=photos-private-bucket
NEXT_PUBLIC_SITE_URL=https://your-domain.com
MP_WEBHOOK_SECRET=your_webhook_secret_32_chars_minimum
TOKEN_EXPIRY_DAYS=30

# Rate Limiting Store (Memory in dev, Redis in production)
RATE_LIMIT_STORE_TYPE=memory  # memory | redis
RATE_LIMIT_REDIS_URL=redis://localhost:6379

# Anti-hotlinking protection
TRUSTED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# =============================================================================
# üö® ALERTS & NOTIFICATIONS
# =============================================================================

# Webhook URLs for alerts
ALERT_WEBHOOK_CRITICAL=https://your-alert-service/critical
ALERT_WEBHOOK_WARNING=https://your-alert-service/warning
ALERT_WEBHOOK_INFO=https://your-alert-service/info

# Email Notifications
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=alerts@your-domain.com
SMTP_PASS=your_email_password
ALERT_EMAIL_TO=admin@your-domain.com

# =============================================================================
# ‚ö° PERFORMANCE OPTIMIZATION
# =============================================================================

# Caching
ENABLE_REDIS_CACHE=true
CACHE_TTL_GALLERY=3600       # 1 hour
CACHE_TTL_SIGNED_URLS=300    # 5 minutes
CACHE_TTL_STATS=1800         # 30 minutes

# Image Optimization
ENABLE_IMAGE_OPTIMIZATION=true
IMAGE_OPTIMIZE_QUALITY=80
IMAGE_OPTIMIZE_CONCURRENT=3

# CDN Configuration
CDN_ENABLED=false
CDN_URL=https://cdn.your-domain.com
CDN_CACHE_CONTROL=public, max-age=31536000

# =============================================================================
# üß™ FEATURE FLAGS
# =============================================================================

# Experimental Features (disable in production)
ENABLE_DEBUG_MODE=false
ENABLE_TEST_ENDPOINTS=false
ENABLE_ADMIN_TOOLS=true
ENABLE_PERFORMANCE_PROFILER=false

# Feature Toggles
ENABLE_AUTO_TAGGING=true
ENABLE_ADVANCED_GALLERY=true
ENABLE_MOBILE_UPLOAD=true
ENABLE_BULK_OPERATIONS=true

# =============================================================================
# üîß OPERATIONAL SETTINGS
# =============================================================================

# Maintenance Mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="Sistema en mantenimiento. Volveremos pronto."

# Backup & Recovery
AUTO_BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# Database Maintenance
AUTO_VACUUM_ENABLED=true
CONNECTION_POOL_SIZE=10
CONNECTION_POOL_TIMEOUT=30000

# =============================================================================
# üì± MOBILE & PWA SETTINGS
# =============================================================================

# Progressive Web App
PWA_ENABLED=true
PWA_OFFLINE_FALLBACK=true
PWA_CACHE_VERSION=1.0.0

# Mobile Optimization
MOBILE_VIEWPORT_OPTIMIZATION=true
MOBILE_GESTURE_HANDLING=true

# =============================================================================
# üåê INTERNATIONALIZATION
# =============================================================================

# Default Language
DEFAULT_LOCALE=es
SUPPORTED_LOCALES=es,en
ENABLE_LOCALE_DETECTION=true

# =============================================================================
# üîê COMPLIANCE & PRIVACY
# =============================================================================

# GDPR Compliance
ENABLE_COOKIE_CONSENT=true
PRIVACY_POLICY_URL=https://your-domain.com/privacy
TERMS_OF_SERVICE_URL=https://your-domain.com/terms

# Data Retention
USER_DATA_RETENTION_DAYS=365
LOG_RETENTION_DAYS=90
ANALYTICS_RETENTION_DAYS=90

# =============================================================================
# üöÄ DEPLOYMENT SETTINGS
# =============================================================================

# Build Configuration
BUILD_STANDALONE=true
BUILD_COMPRESS=true
BUILD_ANALYZE=false

# Runtime Configuration
MAX_MEMORY_USAGE=512
MAX_CPU_USAGE=80
GRACEFUL_SHUTDOWN_TIMEOUT=30000

# Container Settings (if using Docker)
CONTAINER_PORT=3000
CONTAINER_MEMORY_LIMIT=1G
CONTAINER_CPU_LIMIT=1

# =============================================================================
# üîç DEBUGGING & TROUBLESHOOTING (Development Only)
# =============================================================================

# Debug Settings (DISABLE in production)
DEBUG_ENABLED=false
DEBUG_LEVEL=error
DEBUG_SQL_QUERIES=false
DEBUG_API_REQUESTS=false
DEBUG_PERFORMANCE=false

# Development Overrides (REMOVE in production)
# DEV_SKIP_AUTH=false
# DEV_MOCK_PAYMENTS=false
# DEV_DISABLE_RATE_LIMIT=false